document.addEventListener("DOMContentLoaded", () => {
    const flowTypeSelect = document.getElementById("flowType");
    const jurisdictionSelect = document.getElementById("jurisdiction");
    const jurisdictionCheckboxContainer = document.getElementById("jurisdiction-checkbox-container");
    const assetClassSelect = document.getElementById("assetClass");

    // Default jurisdictions for non-TRAX asset classes
    const defaultJurisdictions = `
        <option value="JFSA">JFSA</option>
        <option value="CANADA">CANADA</option>
        <option value="CFTC">CFTC</option>
        <option value="SEC">SEC</option>
        <option value="HKMA">HKMA</option>
        <option value="ESMA">ESMA</option>
        <option value="HKTR">HKTR</option>
        <option value="FCA">FCA</option>
        <option value="MAS">MAS</option>
        <option value="ASIC">ASIC</option>
    `;

    // Function to update jurisdictions dynamically
    function updateJurisdictions() {
        const selectedFlowType = flowTypeSelect.value;
        const selectedAssetClass = assetClassSelect.value;

        if (selectedFlowType === "onereg") {
            if (selectedAssetClass === "TRAX") {
                // TRAX-specific jurisdiction options for "OneReg"
                jurisdictionSelect.innerHTML = `
                    <option value="TRAXCASH">TRAXCASH</option>
                    <option value="TRAXNONCASH">TRAXNONCASH</option>
                    <option value="TRAXNONCASHOTC">TRAXNONCASHOTC</option>
                `;
                jurisdictionSelect.style.display = "block";
                jurisdictionCheckboxContainer.style.display = "none";
            } else {
                // For other asset classes, multiple jurisdictions
                jurisdictionSelect.style.display = "none";
                jurisdictionCheckboxContainer.style.display = "block";
            }
        } else if (selectedFlowType === "file") {
            if (selectedAssetClass === "TRAX") {
                // TRAX-specific jurisdiction for "File"
                jurisdictionSelect.innerHTML = `
                    <option value="TRAX">TRAX</option>
                `;
                jurisdictionSelect.style.display = "block";
                jurisdictionCheckboxContainer.style.display = "none";
            } else {
                // Default jurisdiction options for other asset classes
                jurisdictionSelect.innerHTML = defaultJurisdictions;
                jurisdictionSelect.style.display = "block";
                jurisdictionCheckboxContainer.style.display = "none";
            }
        } else {
            // Default jurisdiction behavior
            jurisdictionSelect.style.display = "block";
            jurisdictionCheckboxContainer.style.display = "none";
        }
    }

    // Event listeners
    flowTypeSelect.addEventListener("change", updateJurisdictions);
    assetClassSelect.addEventListener("change", updateJurisdictions);
});
