SELECT 
    CTJDBSM.TRADEJURISDICTIONDETAILSBUYERSELLERMIFID2ID,  -- From CASH_TRADEJURISDICTIONDETAILSBUYERSELLERMIFID2
    CTJDSM.TRADEJURISDICTIONDETAILSMIFID2ID,              -- From CASH_TRADEJURISDICTIONDETAILSMIFID2
    CTJ.TRADEJURISDICTIONID,                              -- From CASH_TRADEJURISDICTION
    CT.TRADEID,                                           -- From CASH_TRADE
    CT.PUBLISHERTRADEID,                                  -- From CASH_TRADE
    CT.PUBLISHERTRADEVERSION,                             -- From CASH_TRADE
    CT.PUBLISHERTRADEIDTYPE,                              -- From CASH_TRADE
    CT.CTYSDSID,                                          -- From CASH_TRADE
    CT.BOOK                                               -- From CASH_TRADE
FROM 
    CASH_TRADEJURISDICTIONDETAILSBUYERSELLERMIFID2 CTJDBSM
JOIN 
    CASH_TRADEJURISDICTIONDETAILSMIFID2 CTJDSM 
    ON CTJDBSM.TRADEJURISDICTIONDETAILSMIFID2ID = CTJDSM.TRADEJURISDICTIONDETAILSMIFID2ID
JOIN 
    CASH_TRADEJURISDICTION CTJ 
    ON CTJDSM.TRADEJURISDICTIONID = CTJ.TRADEJURISDICTIONID
JOIN 
    CASH_TRADE CT 
    ON CTJ.TRADEID = CT.TRADEID
WHERE 
    CT.brr_load_dt BETWEEN '2023-01-01' AND '2023-03-31'   -- Business date range filter
    AND CT.onpremflag = 1;                                 -- On-prem flag condition
